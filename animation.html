<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Animation Avion + Explosion</title>
    <style>
        body {
            background-color: #87CEEB;
            /* Ciel bleu */
            overflow: hidden;
            margin: 0;
            height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* Bouton */
        #launchButton {
            position: fixed;
            bottom: 20px;
            right: 20px;
            padding: 15px 20px;
            font-size: 16px;
            background-color: orange;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            z-index: 10;
        }

        /* Conteneur de l'animation */
        #animationContainer {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: none;
            /* Caché par défaut */
        }

        /* Avion */
        #plane {
            position: fixed;
            bottom: 280px;
            right: 60px;
            width: 50px;
            opacity: 0;
            transition: opacity 0.3s;
        }

        /* Bâtiment */
        #building {
            position: fixed;
            top: 50%;
            left: 90%;
            width: 100px;
            opacity: 1;
        }

        /* Explosion */
        .explosion {
            position: fixed;
            width: 150px;
            height: 150px;
            pointer-events: none;
            animation: explode 0.5s ease-out forwards;
        }

        /* Animation de vol avec zigzag + retournement */
        @keyframes fly {
            0% {
                bottom: 50px;
                right: 40px;
                transform: rotate(0deg) scaleX(1);
            }

            49% {
                bottom: 50%;
                right: 80%;
                transform: rotate(-15deg) scale(1);
            }

            50% {
                bottom: 50%;
                right: 80%;
                transform: rotate(-15deg) scaleX(-1);
                /* Avion normal */
            }

            75% {
                bottom: 70%;
                right: 50%;
                transform: rotate(10deg) scaleX(-1);
            }

            100% {
                right: 10%;
                bottom: 50%;
                transform: rotate(-5deg) scaleX(-1);
            }
        }

        /* Animation explosion */
        @keyframes explode {
            0% {
                transform: scale(1);
            }

            100% {
                transform: scale(1.5);
            }
        }
    </style>
</head>

<body>

    <!-- Bouton -->
    <button id="launchButton">✈️ Décollage !</button>

    <!-- Conteneur de l'animation -->
    <div id="animationContainer">
        <img id="plane" src="https://www.flight-simulator-world.org/wp-content/uploads/2018/03/boeing-767.jpg"
            alt="Avion">
        <img id="building"
            src="https://media.sudouest.fr/14624688/1000x625/sudouest-photo-1-3792994-1600.jpg?v=1680538411"
            alt="Bâtiment">
    </div>

    <script>
        let isFlying = false; // Vérifie si l'avion est en vol

        document.getElementById("launchButton").addEventListener("click", function () {
            let plane = document.getElementById("plane");
            let building = document.getElementById("building");
            let animationContainer = document.getElementById("animationContainer");

            // Si l'avion vole déjà, déclencher l'explosion immédiatement
            if (isFlying) return;

            isFlying = true; // L'avion commence à voler

            // Réinitialiser l'affichage
            animationContainer.style.display = "block";
            plane.style.opacity = "1";
            building.style.opacity = "1";
            plane.style.animation = "none"; // Supprimer l'animation précédente

            // Forcer un reflow pour relancer l'animation
            void plane.offsetWidth;

            // Lancer l'animation
            plane.style.animation = "fly 4s ease-in-out forwards"; // Zigzag durant 4s

            // Fin de l'animation après 4s
            setTimeout(() => {
                isFlying = false; // L'avion a terminé son vol
                plane.style.opacity = "0";
                building.style.opacity = "0";
                setTimeout(() => {
                    animationContainer.style.display = "none"; // Tout cacher après disparition
                }, 500);
            }, 4000);
        });

        // Déclencher l'explosion à la position du curseur
        document.addEventListener("click", function (event) {
            if (event.target.id === "launchButton") return;

            if (!isFlying) return;
            else {
                let explosion = document.createElement("img");
                explosion.src = "https://i.gifer.com/YQDj.gif";
                explosion.classList.add("explosion");
                explosion.style.left = (event.clientX - 75) + "px"; // Centrer par rapport au curseur
                explosion.style.top = (event.clientY - 75) + "px";
                document.body.appendChild(explosion);

                // Supprimer l'explosion après 1 seconde
                setTimeout(() => {
                    explosion.remove();
                }, 1000);
            }
        });

    </script>

</body>

</html>